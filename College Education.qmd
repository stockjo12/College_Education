---
title: "College Education"
author: "Cooper Riggs & Stockton Nelson"
format: pdf
editor: visual
---

## Setup

```{r}
#Downloading Libraries
library(tidyverse)

#Bringing in Data
salary <- vroom::vroom("Salary.csv") |>
  janitor::clean_names() |>
  rename(major = major_category)
```

## Problem 2 (Stockton)

### Impact of GPA on Salary

```{r}
#Running Linear Model with GPA 
lmgpa <- lm(salary ~ gpa, data = salary)

#Running Confidence Interval on GPA
confint(lmgpa, "gpa", level = 0.95)
```

```{r}
#Making Scatterplot of GPA and Salary
ggplot(data = salary, mapping = aes(x = gpa, y = salary)) +
  geom_point(color = "darkgreen", alpha = 0.8) +
  geom_smooth(method = lm, se = T, color = "forestgreen", fill = "palegreen") +
  scale_x_continuous(breaks = c(1.5, 2.0, 2.5, 3.0, 3.5, 4.0), 
                     labels = function(x) sprintf("%.1f", x)) +
  scale_y_continuous(labels = scales::dollar_format()) +
  labs(x = "GPA",
       y = "Salary",
       title = "The Effect of GPA on Salary",
       caption = "Figure 1: Relationship between GPA and Salary for college students.") +
  theme(plot.caption = element_text(hjust = 0))

ggsave("GPA_salary_plot.png", width = 8, height = 6, dpi = 300)
```

**Answer:** A greater GPA has a positive impact on your salary. For every one point your GPA goes up, we expect your salary to go up somewhere between \$3,300 and \$6,300 dollars. While there is a positive impact on your salary, I do believe that GPA does positively increase your salary, I believe that this can mainly be explained by students with higher GPAs have a greater opportunity in what internships and graduate schools they are able to attend.

### Impact of GPA across Majors

```{r}
#Running Linear Model with GPA and Major Interaction
lmgm <- lm(salary ~ gpa * major, data = salary)

#Running Confidence Interval on GPA
fit <- lm(salary ~ gpa * major, data = salary)
confint(fit, level = 0.95)

salary |> 
  group_by(major) |> 
  summarize(n = n())
```

**Answer:** Looking at the 95% confidence interval for each of these interactions, it's safe to conclude that the effect for GPA is the same, regardless of your major. This could be due to the small sample sizes for each major, but with what data we got, all of these confidence intervals return intervals that contain 0, thus showing that there isn't an interaction.

## Problem 3 (Cooper)

### Differences in Salary Across Major

```{r}
sal_lm <- lm(salary ~ gpa + sex + major, data = salary)
anova(sal_lm)
```

```{r}
library(emmeans)

major_means <- emmeans(sal_lm, ~ major)
confint(major_means)
```

```{r}
plot(major_means,
     ylab = "Major Category",
     xlab = "Adjusted Mean Salary")
ggsave("major_salary_plot.png", width = 8, height = 6, dpi = 300)
```

**Answers:**

Through running an F-test on the the linear model (Salary \~ GPA + Sex + Major) we get an extremely low p-value for major, suggesting that there is sufficient evidence to reject the null hypothesis. This means that there is a difference in salaries across majors. Through further inspection by taking the adjusted means of salaries for each major category we find that Engineering majors have a significantly higher salary. Other majors with higher salaries include Computers & Mathematics, Physical Sciences, Business, and Health.

## Problem 4 (Stockton)

### Differences in Salary Across Sex

```{r}

```

**Answers:**

## Problem 5 (Cooper)

### How Well do the Variables Explain Salary

```{r}
set.seed(123)

cross_validate <- function(fold_num) {
  
  train_data <- salary[folds != fold_num, ]
  test_data  <- salary[folds == fold_num, ]
  
  fit <- lm(
    salary ~ gpa + sex + major,
    data = train_data
  )
  
  preds <- predict(fit, newdata = test_data)
  
  rmse <- sqrt(mean((test_data$salary - preds)^2))
  
  return(rmse)
}

K <- 20

folds <- rep(1:K, length = nrow(salary)) %>%
  sample()

rmse_results <- lapply(1:K, FUN = cross_validate) %>%
  unlist()
mean(rmse_results)
```

```{r}
fold_num <- 3
train_data <- salary[folds != fold_num, ]
test_data  <- salary[folds == fold_num, ]
fit <- lm(salary ~ gpa + sex + major, data = train_data)
example <- test_data[1, ]
example
predicted_salary <- predict(fit, newdata = example)
actual_salary <- example$salary
error <- actual_salary - predicted_salary
print(c(actual_salary, predicted_salary, error))
```

**Answers:**

The variables in the data set do a pretty good job at predicting salary. After RMSE cross-validation, the mean RMSE across the folds is 5717.57. This means that on average, the model can predict a given person's salary with an error of about \$5,717.57. That's okay for predicting, but definitely not great. A couple of factors that are missing that we believe would also contribute to salary are degree level and location of the job. Adding these factors would likely lower the average RMSE. A specific example that shows how this model performs is if you had a female that majored in Communication and Journalism with a 2.79 GPA and a salary of \$84,200. The model would predict someone with these characteristics to have a salary of \$76,512.96, this is off by \$7,687.03. We would say that the difference between \$84,200 and \$76,512 in salary is fairly significant.
